getwd()
setwd("F:/Janaki & Venky/Data Science/Data Science Exercises/Exercise 1_ Data Wrangling")
library(dplyr)
library(tidyr)
install.packages(tidyverse)
getwd()
setwd("F:/Janaki & Venky/Data Science/Data Science Exercises/Exercise 1_ Data Wrangling")
library(tidyr)
library(dplyr)
refine_original <- read.csv("refine_original_2.CSV")
product_cat_lookup <- data_frame(product_code = c('p','v','x','q'),
product_categories = c('smartphone','tv','laptop','tablet'))
refine_clean <- refine_original %>%
#standardize companies / fix misspellings
mutate(company = tolower(company)) %>%
mutate(company = sub('ph.*','philips',company)) %>%
mutate(company = sub('fil.*','philips',company)) %>%
mutate(company = sub('ak.*','akzo',company)) %>%
mutate(company = sub('van.*','van houten',company)) %>%
mutate(company = sub('uni.*','unilever',company)) %>%
refine_clean <- refine_original %>%
#standardize companies / fix misspellings
mutate(company = tolower(company)) %>%
mutate(company = sub('ph.*','philips',company)) %>%
mutate(company = sub('fil.*','philips',company)) %>%
mutate(company = sub('ak.*','akzo',company)) %>%
mutate(company = sub('van.*','van houten',company)) %>%
mutate(company = sub('uni.*','unilever',company)) %>%
#separate product_code and product_number then join product_categories
separate(Product.code...number, into = c('product_code','product_number'), sep = "-")
View(refine_clean)
refine_clean <- refine_original %>%
#standardize companies / fix misspellings
mutate(company = tolower(company)) %>%
mutate(company = sub('ph.*','philips',company)) %>%
mutate(company = sub('fil.*','philips',company)) %>%
mutate(company = sub('ak.*','akzo',company)) %>%
mutate(company = sub('van.*','van houten',company)) %>%
mutate(company = sub('uni.*','unilever',company)) %>%
#separate product_code and product_number then join product_categories
separate(Product.code...number, into = c('product_code','product_number'), sep = "-")
View(refine_clean)
View (product_cat_lookup)
join<-merge(refine_clean, product_cat_lookup, "product_code")
view (join)
View (join)
Final <- join %>%
unite(full_address, address:country, sep = ',') %>%
#create binary variables
mutate(company_philips = ifelse(company == 'philips',1,0)) %>%
mutate(company_akzo = ifelse(company == 'akzo',1,0)) %>%
mutate(company_van_houten = ifelse(company == 'van houten',1,0)) %>%
mutate(company_unilever = ifelse(company == 'unilever',1,0)) %>%
mutate(product_smartphone = ifelse(product_categories == 'smartphone',1,0)) %>%
mutate(product_tv = ifelse(product_categories == 'tv',1,0)) %>%
mutate(product_laptop = ifelse(product_categories == 'laptop',1,0)) %>%
mutate(product_tablet = ifelse(product_categories == 'tablet',1,0)) %>%
View (Final)
View (Final)
Final <- join %>%
unite(full_address, address:country, sep = ',') %>%
#create binary variables
mutate(company_philips = ifelse(company == 'philips',1,0)) %>%
mutate(company_akzo = ifelse(company == 'akzo',1,0)) %>%
mutate(company_van_houten = ifelse(company == 'van houten',1,0)) %>%
mutate(company_unilever = ifelse(company == 'unilever',1,0)) %>%
mutate(product_smartphone = ifelse(product_categories == 'smartphone',1,0)) %>%
mutate(product_tv = ifelse(product_categories == 'tv',1,0)) %>%
mutate(product_laptop = ifelse(product_categories == 'laptop',1,0)) %>%
mutate(product_tablet = ifelse(product_categories == 'tablet',1,0)) %>%
View (Final)
View(Final)
View (join)
join<-refine_clean %>%
merge(refine_clean, product_cat_lookup, "product_code") %>%
#create full_address for geocoding
unite(full_address, address:country, sep = ',') %>%
#create binary variables
mutate(company_philips = ifelse(company == 'philips',1,0)) %>%
mutate(company_akzo = ifelse(company == 'akzo',1,0)) %>%
mutate(company_van_houten = ifelse(company == 'van houten',1,0)) %>%
mutate(company_unilever = ifelse(company == 'unilever',1,0)) %>%
mutate(product_smartphone = ifelse(product_categories == 'smartphone',1,0)) %>%
mutate(product_tv = ifelse(product_categories == 'tv',1,0)) %>%
mutate(product_laptop = ifelse(product_categories == 'laptop',1,0)) %>%
mutate(product_tablet = ifelse(product_categories == 'tablet',1,0)) %>%
View(join)
getwd()
setwd("F:/Janaki & Venky/Data Science/Data Science Exercises/Exercise 1_ Data Wrangling")
mydata <- read.csv("refine_original_2.CSV")
install.packages("tidyverse")
library(tidyverse)
library(tidyr)
library(stringr)
library(dplyr)
install.packages("tidyverse")
install.packages("tidyverse")
c_company <- mydata %>%
mutate(lower_company = tolower(company),
first_letter = substr(lower_company, 0, 1),
clean_company = ifelse(first_letter == "p", "phillips",
ifelse(first_letter == "f", "phillips",
ifelse(first_letter == "a", "akzo",
ifelse(first_letter == "v", "van Houten",
ifelse(first_letter == "u", "unliever", first_letter))))))
c_company
Category <- data.frame(product_code = c("p", "v", "x", "q"),product_number = c("Smartphone", "TV", "Laptop", "Tablet"))
Category
Final <- c_company %>%
separate(Product.code...number, into = c('product_code','product_number'), sep = "-")
View(Final)
join<-merge(Final, Category, "product_code")
View(join)
caddress <- join %>%
unite(full_address, address:country, sep = ',')
View(caddress)
result <- caddress %>%
mutate(company_phillips = ifelse(clean_company == 'phillips',1,0)) %>%
mutate(company_akzo = ifelse(clean_company == 'akzo',1,0)) %>%
mutate(company_van_houten = ifelse(clean_company == 'van houten',1,0)) %>%
mutate(company_unilever = ifelse(clean_company == 'unilever',1,0)) %>%
mutate(product_smartphone = ifelse(product_number.y == 'Smartphone',1,0)) %>%
mutate(product_tv = ifelse(product_number.y == 'Tv',1,0)) %>%
mutate(product_laptop = ifelse(product_number.y == 'Laptop',1,0)) %>%
mutate(product_tablet = ifelse(product_number.y == 'Tablet',1,0))
View(result)
write.csv(result, 'Result.csv', row.names = FALSE)
